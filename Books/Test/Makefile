# Makefile for Sphinx documentation
# THIS FILE GENERATED BY 'tools\configure.py' AND 'tools\config_templates.py' SCRIPTS
#
# You can set these variables from the command line.
# PYTHON should match the exec of the rest of OpenDSA
PYTHON = /usr/local/bin/python
SPHINXBUILD   = sphinx-build
SPHINXOPTS    = 
# -E is option to always build from new environment, regardless of changed files
# -vv and -vvv are options for verbose build output
# -P is for starting pdb exactly when and where exception occurs
HTMLDIR       = html/
MINIMIZE      = uglifyjs
TAGS = 
.PHONY: clean html

all: html min

clean:
	-rm -rf ./$(HTMLDIR)*
	-rm source/ToDo.rst

cleanbuild: clean html

min: min-underscore min-doctools min-searchtools

min-underscore:
	@echo 'Minimizing $(HTMLDIR)_static/underscore.js'
	@$(MINIMIZE) $(HTMLDIR)_static/underscore.js > $(HTMLDIR)_static/underscore.js

min-doctools:
	@echo 'Minimizing $(HTMLDIR)_static/doctools.js'
	@$(MINIMIZE) $(HTMLDIR)_static/doctools.js > $(HTMLDIR)_static/doctools.js

min-searchtools:
	@echo 'Minimizing $(HTMLDIR)_static/searchtools.js'
	@$(MINIMIZE) $(HTMLDIR)_static/searchtools.js > $(HTMLDIR)_static/searchtools.js

html:
	$(SPHINXBUILD) $(TAGS) $(SPHINXOPTS) -b html source $(HTMLDIR)
	rm html/_static/jquery.js
	cp "/opendsa/lib/conceptMap.html" $(HTMLDIR)
	rm *.json
	@echo
	@echo "Build finished. The HTML pages are in $(HTMLDIR)."
	rm Makefile

slides:
	@SLIDES=yes 	$(SPHINXBUILD) $(SPHINXOPTS) -b slides source $(HTMLDIR)
	rm html/_static/jquery.js
	cp "/opendsa/lib/styles.css" html/_static/ # Overwrites
	rm *.json
	@echo
	@echo "Build finished. The HTML pages are in $(HTMLDIR)."
